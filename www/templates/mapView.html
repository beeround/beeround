<ion-view cache-view="false" view-title="Map">
  <ion-nav-buttons side="right">
    <span class="button button-icon button-clear ion-android-more-vertical" ng-click="openPopover()">
    </span>
  </ion-nav-buttons>

  <ion-content scroll="false">
    <div class="row searchbox">
      <div class="col col-80 list list-inset no-padding-right">
        <label class="item item-input">
          <i class="icon ion-search placeholder-icon"></i>
          <input id="searchLocation" g-places-autocomplete force-selection="true" options="autocompleteOptions" ng-model="place" type="text"
                 placeholder="Standort eingeben">
        </label>
      </div>
      <div class="col col-10list list-inset no-padding-left">
        <button class="button-geolocation" ng-click="newGeolocation()">
          <i class="ion-ios-location"></i>
        </button>
      </div>
    </div>

    <!--<div class="card">
      <div class="item item-text-wrap">
        <h3>{{location.town || location.village}}</h3>
        <h3>Radius: {{userSettings.radius}}km</h3>
      </div>
    </div>
    -->

    <ng-map on-zoom_changed="zoomChanged()" zoom="{{zoom}}" center="{{userSettings.lat}}, {{userSettings.lng}}">
      <marker position="{{userSettings.lat}}, {{userSettings.lng}}" animation="Animation.BOUNCE" centered="true"></marker>
      <marker ng-repeat="marker in markers" id="{{marker.id}}" position="{{marker.lat}},{{marker.lng}}" on-click="showTextbox({{marker}})"></marker>
      <info-window id="overlay">

        <div>
          <h5>{{boxContent.name}}</h5>
          <p>{{boxContent.lat}}, {{boxContent.lng}}</p>
          <p>{{boxContent.lat}}, {{boxContent.lng}}</p>
        </div>

      </info-window>
    </ng-map>

    <script id="filter.html" type="text/ng-template">
      <ion-popover-view>

      <ion-content>

        <!--Filter, in which radius the brewery should be away from the user-->
        <div ng-show="userSettings.lat" class="card">
          <div class="item item-text-wrap">
            <h5>Radius</h5>
            <button ng-class="{'active' : userSettings.radius == 10}" ng-click="setRadius(10)">10km</button>
            <button ng-class="{'active' : userSettings.radius == 30}" ng-click="setRadius(30)">30km</button>
            <button ng-class="{'active' : userSettings.radius == 50}" ng-click="setRadius(50)">50km</button>
          </div>

          <div class="item item-text-wrap">
            <h5>Typ</h5>
            <button ng-class="{'active' : filterLocationType == 'brewpub'}"  ng-click="setType('brewpub')">mit Restaurant</button>
          </div>

          <div class="item item-text-wrap">
            <h5>Sortieren</h5>
            <div ng-model="sortingOptions">
              <button ng-click="sortBy('name')" class="sortorder" ng-class="{active: activeSorting == 'name'}">Name</button>
              <button ng-click="sortBy('rating')" class="sortorder" ng-class="{active: activeSorting == 'rating'}">Bewertung</button>
              <button ng-click="sortBy('distance')" class="sortorder" ng-class="{active: activeSorting == 'distance'}">Entfernung
              </button>
            </div>
          </div>

          <div class="item item-text-wrap">
            <button ng-click="closePopover()">Schlie√üen</button>
          </div>

        </div>
      </ion-content>
      </ion-popover-view>
    </script>

  </ion-content>


</ion-view>
